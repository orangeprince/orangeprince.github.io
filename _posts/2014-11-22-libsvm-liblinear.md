---
layout: post-no-feature
title: "说说LIBSVM与LIBLINEAR(一)"
category: "机器学习"
tags: [开发工具,SVM]
---

在过去的十几年里，支持向量机（Support Vector Machines）应该算得上是机器学习领域影响力最大的算法了。而在SVM算法的各种实现工具中，由国立台湾大学林智仁老师开发的工具包libsvm，又无疑是影响力最大的。2011年libsvm的系统介绍论文“LIBSVM: a library for support vector machines”发表在了期刊ACM TIST(ACM Transactions on Intelligent Systems and Technology)上。2011年的时候，这个期刊的影响因子还不到1，但到了2014年，它的影响因子居然达到了9.39，把TPAMI都甩出了一大截。这其中贡献最大的当然是关于libsvm的这篇论文，在google scholar上，这篇文章的引用量居然已经接近20000，着实吓人。仔细想来其实也并不奇怪，各种研究工作，只要涉及到分类，大部分都会用到SVM算法或者与SVM的算法进行对比，而此时libsvm往往是首选工具。其实不但是学术界，在工业界libsvm也有非常广泛的应用。这一方面得益于算法实现的稳定与高效，另一方面也是因为libsvm提供了丰富的接口与灵活的使用方式。一些非常有名的机器学习工具，如基于java的Weka和基于python的scikit-learn，其提供的SVM算法在底层也是基于libsvm的实现。

几年前参加过一个机器学习的学习班，主讲人是CMU的Eric Xing老师。在提问环节，大家都在讨论一些高深的理论问题，突然有一个女生举手提问主讲人如果要用SVM的话有什么工具推荐使用。这个问题在当时的场景似乎有点不合时宜，Eric Xing老师回答说他们CMU从来不用别人的库，所有的算法代码都是自己实现的云云。后来那次讲座上其他的东西我都不太记得了，印象最深的就变成了这个问答。现在想来，如果从算法学习角度，自己实现这些算法对于理论的理解和工程能力的提升都是大有好处。但是对于绝大部分人来说，自己动手实现的SVM算法在效率和扩展性上，还是会和libsvm的算法实现存在不小的差距，毕竟人家的程序是千锤百炼中产生的。如果单纯为了使用的话，一个大家都认可的好工具绝不失为一个很好地选择。但是，有一个好的工具并不等于我们可以对算法与实现一无所知而把所有的事情都交给工具。相反，如果我们能够很好地了解算法与实现中的一些背景知识，可以更好地使用这些工具。此外，libsvm与他的姊妹工具liblinear提供了丰富的优化与参数选项，通过选择适当的方法，也可以大大提高我们的工作效率。因此，下面总结一些在我之前的工作中遇到的一些与libsvm和liblinear相关的重要问题，希望能够对读者对这些工具的使用有所帮助。

##libsvm与liblinear的区别
这是很多刚开始使用SVM的人容易弄混淆的问题。简单来说，libsvm是一个完整的SVM模型实现。用户可以在libsvm中使用和核函数来训练非线性的分类器，当然也能使用更基础的线性SVM。而liblinear是一个针对线性分类场景而设计的工具包，除了支持线性的SVM外，还可以支持线性的Logistical Regression等模型，但是无法通过定义核函数方式实现非线性的分类器。由于支持核函数的扩展，libsvm理论上具有比liblinear更强的分类能力，能够处理更为复杂的问题。但是，很多人因此就只使用libsvm，甚至最简单的线性分类器都是用libsvm来训练和预测，这也是不可取的。因为liblinear设计的初衷就是为了提高线性分类的效率，其优化算法与libsvm中的优化算法有着根本的区别。虽然在进行线性分类时libsvm和liblinear都可以达到类似的结果，但是liblinear无论是在训练上还是在预测上，都比libsvm高效得多。此外，受限于算法，libsvm往往在样本量过万之后速度就比较慢了，如果样本量再上升一个数量级，那么通常的机器已经无法处理了。但使用liblinear，则完全不需要有这方面的担忧，即便百万千万级别的数据，liblinear也可以轻松搞定，因为liblinear本身就是为了解决较大规模样本的模型训练而设计的。